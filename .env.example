# AttackFlow Environment Configuration
# ==============================================================================
# Copy this file to .env and fill in your values
# IMPORTANT: Never commit the .env file to version control
#
# SECURITY GUIDELINES:
# 1. Use strong, unique secrets for production (minimum 32 characters)
# 2. Rotate secrets periodically (recommended: every 90 days)
# 3. Use different secrets for each environment (dev, staging, prod)
# 4. Store production secrets in a secure vault (e.g., AWS Secrets Manager)
# 5. Never log or expose secrets in error messages
#
# OWASP Reference: A02:2021 - Cryptographic Failures
# ==============================================================================

# ==============================================
# SERVER CONFIGURATION
# ==============================================
# Environment: 'development' or 'production'
# In production mode, stricter security checks are enforced
NODE_ENV=development
PORT=3000

# ==============================================
# SESSION CONFIGURATION
# ==============================================
# SESSION_SECRET: Critical security setting
#
# Requirements:
# - Minimum 32 characters for production
# - Must be cryptographically random
# - Must be unique per deployment
#
# Generate a secure secret using one of these commands:
#   openssl rand -hex 32
#   node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# IMPORTANT: Rotate this secret periodically. When rotated:
# - All active sessions will be invalidated
# - Users will need to log in again
SESSION_SECRET=your-secure-session-secret-change-in-production

# Session cookie settings
# SESSION_COOKIE_SECURE: Set to 'true' in production (requires HTTPS)
# SESSION_COOKIE_MAX_AGE: Session duration in milliseconds (default: 24 hours)
SESSION_COOKIE_SECURE=false
SESSION_COOKIE_MAX_AGE=86400000

# ==============================================
# DATABASE CONFIGURATION
# ==============================================
# Database credentials
# IMPORTANT: Use a dedicated database user with minimal required permissions
# Never use 'root' in production - create a specific user for this application
DB_HOST=localhost
DB_PORT=3306
DB_NAME=attackflow
DB_USER=root
DB_PASSWORD=

# Connection pool settings
# DB_CONNECTION_LIMIT: Maximum concurrent connections (default: 10)
# DB_QUEUE_LIMIT: Maximum queued requests (0 = unlimited)
DB_CONNECTION_LIMIT=10
DB_QUEUE_LIMIT=0

# ==============================================
# RATE LIMITING CONFIGURATION
# ==============================================
# Rate limiting protects against:
# - Brute-force attacks on authentication
# - Denial of Service (DoS) attacks
# - API abuse and scraping
#
# OWASP Reference: API4:2023 - Unrestricted Resource Consumption

# General API rate limit (baseline protection for all endpoints)
# Default: 100 requests per 15 minutes per IP+User
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Authentication endpoints (login, signup) - stricter limits
# Default: 5 attempts per 15 minutes per IP
AUTH_RATE_LIMIT_WINDOW_MS=900000
AUTH_RATE_LIMIT_MAX_REQUESTS=5

# File upload rate limit
# Default: 20 uploads per hour per user
UPLOAD_RATE_LIMIT_WINDOW_MS=3600000
UPLOAD_RATE_LIMIT_MAX_REQUESTS=20

# Read-only endpoint rate limit (GET requests for data)
# Default: 60 requests per minute per IP+User
READ_RATE_LIMIT_WINDOW_MS=60000
READ_RATE_LIMIT_MAX_REQUESTS=60

# Mutation rate limit (POST/PUT/DELETE for data changes)
# Default: 30 mutations per minute per IP+User
MUTATION_RATE_LIMIT_WINDOW_MS=60000
MUTATION_RATE_LIMIT_MAX_REQUESTS=30

# Download rate limit (file downloads)
# Default: 50 downloads per hour per user
DOWNLOAD_RATE_LIMIT_WINDOW_MS=3600000
DOWNLOAD_RATE_LIMIT_MAX_REQUESTS=50

# ==============================================
# SECURITY CONFIGURATION
# ==============================================
# Bcrypt salt rounds for password hashing
# Higher values = more secure but slower authentication
# Recommended: 12 for production (takes ~250ms per hash)
# Note: Each increment doubles the computation time
BCRYPT_SALT_ROUNDS=12

# Maximum file upload size in bytes
# Default: 50MB (52428800 bytes)
# Adjust based on your expected file sizes
MAX_FILE_SIZE=52428800

# Allowed file extensions for upload (comma-separated, lowercase)
# Only allow necessary file types to reduce attack surface
ALLOWED_FILE_EXTENSIONS=.pdf,.doc,.docx,.txt

# ==============================================
# CORS CONFIGURATION (Optional)
# ==============================================
# Uncomment and configure if serving frontend from different origin
# CORS_ORIGIN=http://localhost:3000

# ==============================================
# LOGGING CONFIGURATION
# ==============================================
# Log level for request logging
# Options: 'dev' (colored), 'combined' (Apache-style, recommended for production)
LOG_LEVEL=dev

# ==============================================
# API KEY MANAGEMENT (Future Use)
# ==============================================
# If integrating with external APIs, add keys here following these guidelines:
#
# 1. Naming convention: SERVICE_NAME_API_KEY (e.g., OPENAI_API_KEY)
# 2. Never hardcode API keys in source code
# 3. Use separate API keys for each environment
# 4. Set appropriate rate limits and permissions on API keys
# 5. Monitor API key usage for anomalies
# 6. Rotate keys immediately if compromised
#
# Example (do not uncomment until needed):
# EXTERNAL_SERVICE_API_KEY=your-api-key-here
